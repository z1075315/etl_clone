/*
select the demographics for the below conditions.
1. join Stage_Demographics and Store tables based on store number and sales org for all active stores.
*/
DELETE FROM `{{ params.project_ID }}.{{ params.Optumera_Target_DS }}.Store_Demographics` WHERE TRUE;
INSERT
	`{{ params.project_ID }}.{{ params.Optumera_Target_DS }}.Store_Demographics` ( STORE_ID,
	DP_VAR_1,
	DP_VAR_2,
	DP_VAR_3,
	DP_VAR_4,
	DP_VAR_5,
	DP_VAR_6,
	DP_VAR_7,
	DP_VAR_8,
	DP_VAR_9,
	DP_VAR_10,
	DP_VAR_11,
	DP_VAR_12,
	DP_VAR_13,
	DP_VAR_14,
	DP_VAR_15,
	DP_VAR_16,
	DP_VAR_17,
	DP_VAR_18,
	DP_VAR_19,
	DP_VAR_20,
	DP_VAR_21,
	DP_VAR_22,
	DP_VAR_23,
	DP_VAR_24,
	DP_VAR_25,
	DP_VAR_26,
	DP_VAR_27,
	DP_VAR_28,
	DP_VAR_29,
	DP_VAR_30,
	DP_VAR_31,
	DP_VAR_32,
	DP_VAR_33,
	DP_VAR_34,
	DP_VAR_35,
	DP_VAR_36,
	DP_VAR_37,
	DP_VAR_38,
	DP_VAR_39,
	DP_VAR_40,
	DP_VAR_41,
	DP_VAR_42,
	DP_VAR_43,
	DP_VAR_44,
	DP_VAR_45,
	DP_VAR_46,
	DP_VAR_47,
	DP_VAR_48,
	DP_VAR_49,
	DP_VAR_50,
	DP_VAR_51,
	DP_VAR_52,
	DP_VAR_53,
	DP_VAR_54,
	DP_VAR_55,
	DP_VAR_56,
	DP_VAR_57,
	DP_VAR_58,
	DP_VAR_59,
	DP_VAR_60,
	DP_VAR_61,
	DP_VAR_62,
	DP_VAR_63,
	DP_VAR_64,
	DP_VAR_65,
	DP_VAR_66,
	DP_VAR_67,
	DP_VAR_68,
	DP_VAR_69,
	DP_VAR_70,
	DP_VAR_71,
	DP_VAR_72,
	DP_VAR_73,
	DP_VAR_74,
	DP_VAR_75,
	DP_VAR_76,
	DP_VAR_77,
	DP_VAR_78,
	DP_VAR_79,
	DP_VAR_80,
	DP_VAR_81,
	DP_VAR_82,
	DP_VAR_83,
	DP_VAR_84,
	DP_VAR_85,
	DP_VAR_86,
	DP_VAR_87,
	DP_VAR_88,
	DP_VAR_89,
	DP_VAR_90,
	DP_VAR_91,
	DP_VAR_92,
	DP_VAR_93,
	DP_VAR_94,
	DP_VAR_95,
	DP_VAR_96,
	DP_VAR_97,
	DP_VAR_98,
	DP_VAR_99,
	DP_VAR_100,
	DP_VAR_101,
	DP_VAR_102,
	DP_VAR_103,
	DP_VAR_104,
	DP_VAR_105,
	DP_VAR_106,
	DP_VAR_107,
	DP_VAR_108,
	DP_VAR_109,
	DP_VAR_110,
	DP_VAR_111,
	DP_VAR_112,
	DP_VAR_113,
	DP_VAR_114,
	DP_VAR_115,
	DP_VAR_116,
	DP_VAR_117,
	DP_VAR_118,
	DP_VAR_119,
	DP_VAR_120,
	DP_VAR_121,
	DP_VAR_122,
	DP_VAR_123,
	DP_VAR_124,
	DP_VAR_125,
	DP_VAR_126,
	DP_VAR_127,
	DP_VAR_128,
	DP_VAR_129,
	DP_VAR_130,
	DP_VAR_131,
	DP_VAR_132,
	DP_VAR_133,
	DP_VAR_134,
	DP_VAR_135,
	DP_VAR_136,
	DP_VAR_137,
	DP_VAR_138,
	DP_VAR_139,
	DP_VAR_140,
	DP_VAR_141,
	DP_VAR_142,
	DP_VAR_143,
	DP_VAR_144,
	DP_VAR_145,
	DP_VAR_146,
	DP_VAR_147,
	DP_VAR_148,
	DP_VAR_149,
	DP_VAR_150,
	DP_VAR_151,
	DP_VAR_152,
	DP_VAR_153,
	DP_VAR_154,
	DP_VAR_155,
	DP_VAR_156,
	DP_VAR_157,
	DP_VAR_158,
	DP_VAR_159,
	DP_VAR_160,
	DP_VAR_161,
	DP_VAR_162,
	DP_VAR_163,
	DP_VAR_164,
	DP_VAR_165,
	DP_VAR_166,
	DP_VAR_167,
	DP_VAR_168,
	DP_VAR_169,
	DP_VAR_170,
	DP_VAR_171,
	DP_VAR_172,
	DP_VAR_173,
	DP_VAR_174,
	DP_VAR_175,
	DP_VAR_176,
	DP_VAR_177,
	DP_VAR_178,
	DP_VAR_179,
	DP_VAR_180,
	DP_VAR_181,
	DP_VAR_182,
	DP_VAR_183,
	DP_VAR_184,
	DP_VAR_185,
	DP_VAR_186,
	DP_VAR_187,
	DP_VAR_188,
	DP_VAR_189,
	DP_VAR_190,
	DP_VAR_191,
	DP_VAR_192,
	DP_VAR_193,
	DP_VAR_194,
	DP_VAR_195,
	DP_VAR_196,
	DP_VAR_197,
	DP_VAR_198,
	DP_VAR_199,
	DP_VAR_200,
	DP_VAR_201,
	DP_VAR_202,
	DP_VAR_203,
	DP_VAR_204,
	DP_VAR_205,
	DP_VAR_206,
	DP_VAR_207,
	DP_VAR_208,
	DP_VAR_209,
	DP_VAR_210,
	DP_VAR_211,
	DP_VAR_212,
	DP_VAR_213,
	DP_VAR_214,
	DP_VAR_215,
	DP_VAR_216,
	DP_VAR_217,
	DP_VAR_218,
	DP_VAR_219,
	DP_VAR_220,
	DP_VAR_221,
	DP_VAR_222,
	DP_VAR_223,
	DP_VAR_224,
	DP_VAR_225,
	DP_VAR_226,
	DP_VAR_227,
	DP_VAR_228,
	DP_VAR_229,
	DP_VAR_230,
	DP_VAR_231,
	DP_VAR_232,
	DP_VAR_233,
	DP_VAR_234,
	DP_VAR_235,
	DP_VAR_236,
	DP_VAR_237,
	DP_VAR_238,
	DP_VAR_239,
	DP_VAR_240,
	DP_VAR_241,
	DP_VAR_242,
	DP_VAR_243,
	DP_VAR_244,
	DP_VAR_245,
	DP_VAR_246,
	DP_VAR_247,
	DP_VAR_248,
	DP_VAR_249,
	DP_VAR_250,
	DP_VAR_251,
	DP_VAR_252,
	DP_VAR_253,
	DP_VAR_254,
	DP_VAR_255,
	DP_VAR_256,
	DP_VAR_257,
	DP_VAR_258,
	DP_VAR_259,
	DP_VAR_260,
	DP_VAR_261,
	DP_VAR_262,
	DP_VAR_263,
	DP_VAR_264,
	DP_VAR_265,
	DP_VAR_266,
	DP_VAR_267,
	DP_VAR_268,
	DP_VAR_269,
	DP_VAR_270,
	DP_VAR_271,
	DP_VAR_272,
	DP_VAR_273,
	DP_VAR_274,
	DP_VAR_275,
	DP_VAR_276,
	DP_VAR_277,
	DP_VAR_278,
	DP_VAR_279,
	CREATED_USER,
	CREATED_TS,
	UPDATED_USER,
	UPDATED_TS) (
SELECT
	ts.Store_ID,
	IFNULL(Tot_P_M,0),
	IFNULL(Tot_P_F,0),
	IFNULL(Tot_P_P,0),
	IFNULL(Age_0_4_yr_M,0),
	IFNULL(Age_0_4_yr_F,0),
	IFNULL(Age_0_4_yr_P,0),
	IFNULL(Age_5_14_yr_M,0),
	IFNULL(Age_5_14_yr_F,0),
	IFNULL(Age_5_14_yr_P,0),
	IFNULL(Age_15_19_yr_M,0),
	IFNULL(Age_15_19_yr_F,0),
	IFNULL(Age_15_19_yr_P,0),
	IFNULL(Age_20_24_yr_M,0),
	IFNULL(Age_20_24_yr_F,0),
	IFNULL(Age_20_24_yr_P,0),
	IFNULL(Age_25_34_yr_M,0),
	IFNULL(Age_25_34_yr_F,0),
	IFNULL(Age_25_34_yr_P,0),
	IFNULL(Age_35_44_yr_M,0),
	IFNULL(Age_35_44_yr_F,0),
	IFNULL(Age_35_44_yr_P,0),
	IFNULL(Age_45_54_yr_M,0),
	IFNULL(Age_45_54_yr_F,0),
	IFNULL(Age_45_54_yr_P,0),
	IFNULL(Age_55_64_yr_M,0),
	IFNULL(Age_55_64_yr_F,0),
	IFNULL(Age_55_64_yr_P,0),
	IFNULL(Age_65_74_yr_M,0),
	IFNULL(Age_65_74_yr_F,0),
	IFNULL(Age_65_74_yr_P,0),
	IFNULL(Age_75_84_yr_M,0),
	IFNULL(Age_75_84_yr_F,0),
	IFNULL(Age_75_84_yr_P,0),
	IFNULL(Age_85ov_M,0),
	IFNULL(Age_85ov_F,0),
	IFNULL(Age_85ov_P,0),
	IFNULL(Average_household_size,0),
	IFNULL(Aust_Tot_Resp,0),
	IFNULL(Aust_Abor_Tot_Resp,0),
	IFNULL(Chinese_Tot_Resp,0),
	IFNULL(Croatian_Tot_Resp,0),
	IFNULL(Dutch_Tot_Resp,0),
	IFNULL(English_Tot_Resp,0),
	IFNULL(Filipino_Tot_Resp,0),
	IFNULL(French_Tot_Resp,0),
	IFNULL(German_Tot_Resp,0),
	IFNULL(Greek_Tot_Resp,0),
	IFNULL(Hungarian_Tot_Resp,0),
	IFNULL(Indian_Tot_Resp,0),
	IFNULL(Irish_Tot_Resp,0),
	IFNULL(Italian_Tot_Resp,0),
	IFNULL(Korean_Tot_Resp,0),
	IFNULL(Lebanese_Tot_Resp,0),
	IFNULL(Macedonian_Tot_Resp,0),
	IFNULL(Maltese_Tot_Resp,0),
	IFNULL(Maori_Tot_Resp,0),
	IFNULL(NZ_Tot_Resp,0),
	IFNULL(Polish_Tot_Resp,0),
	IFNULL(Russian_Tot_Resp,0),
	IFNULL(Scottish_Tot_Resp,0),
	IFNULL(Serbian_Tot_Resp,0),
	IFNULL(Sth_African_Tot_Resp,0),
	IFNULL(Spanish_Tot_Resp,0),
	IFNULL(Sri_Lankan_Tot_Resp,0),
	IFNULL(Turkish_Tot_Resp,0),
	IFNULL(Vietnamese_Tot_Resp,0),
	IFNULL(Welsh_Tot_Resp,0),
	IFNULL(Other_Tot_Resp,0),
	IFNULL(Tot_P_Tot_Resp,0),
	IFNULL(P_Afghanistan_Tot,0),
	IFNULL(P_Australia_Tot,0),
	IFNULL(P_Bangladesh_Tot,0),
	IFNULL(P_Bosnia_Herzegov_Tot,0),
	IFNULL(P_Cambodia_Tot,0),
	IFNULL(P_Canada_Tot,0),
	IFNULL(P_Chile_Tot,0),
	IFNULL(P_China_Tot,0),
	IFNULL(P_Croatia_Tot,0),
	IFNULL(P_Egypt_Tot,0),
	IFNULL(P_England_Tot,0),
	IFNULL(P_Fiji_Tot,0),
	IFNULL(P_France_Tot,0),
	IFNULL(P_Germany_Tot,0),
	IFNULL(P_Greece_Tot,0),
	IFNULL(P_Hong_Kong_Tot,0),
	IFNULL(P_India_Tot,0),
	IFNULL(P_Indonesia_Tot,0),
	IFNULL(P_Iran_Tot,0),
	IFNULL(P_Iraq_Tot,0),
	IFNULL(P_Ireland_Tot,0),
	IFNULL(P_Italy_Tot,0),
	IFNULL(P_Japan_Tot,0),
	IFNULL(P_Korea_South_Tot,0),
	IFNULL(P_Lebanon_Tot,0),
	IFNULL(P_Malaysia_Tot,0),
	IFNULL(P_Malta_Tot,0),
	IFNULL(P_Mauritius_Tot,0),
	IFNULL(P_Myanmar_Tot,0),
	IFNULL(P_Nepal_Tot,0),
	IFNULL(P_Netherlands_Tot,0),
	IFNULL(P_New_Zealand_Tot,0),
	IFNULL(P_Nthern_Ireland_Tot,0),
	IFNULL(P_Pakistan_Tot,0),
	IFNULL(P_PNG_Tot,0),
	IFNULL(P_Philippines_Tot,0),
	IFNULL(P_Poland_Tot,0),
	IFNULL(P_Scotland_Tot,0),
	IFNULL(P_Singapore_Tot,0),
	IFNULL(P_South_Africa_Tot,0),
	IFNULL(P_SE_Europe_nfd_Tot,0),
	IFNULL(P_Sri_Lanka_Tot,0),
	IFNULL(P_Taiwan_Tot,0),
	IFNULL(P_Thailand_Tot,0),
	IFNULL(P_FYROM_Tot,0),
	IFNULL(P_Turkey_Tot,0),
	IFNULL(P_USA_Tot,0),
	IFNULL(P_Vietnam_Tot,0),
	IFNULL(P_Wales_Tot,0),
	IFNULL(P_Zimbabwe_Tot,0),
	IFNULL(P_Elsewhere_Tot,0),
	IFNULL(Buddhism_P,0),
	IFNULL(Christianity_Tot_P,0),
	IFNULL(Hinduism_P,0),
	IFNULL(Islam_P,0),
	IFNULL(Judaism_P,0),
	IFNULL(Othr_Rel_Sikhism_P,0),
	IFNULL(Other_Religions_Tot_P,0),
	IFNULL(SB_OSB_NRA_Tot_P,0),
	IFNULL(Pre_school_M,0),
	IFNULL(Pre_school_F,0),
	IFNULL(Pre_school_P,0),
	IFNULL(Infants_Primary_Tot_P,0),
	IFNULL(Secondary_Tot_M,0),
	IFNULL(Secondary_Tot_F,0),
	IFNULL(Secondary_Tot_P,0),
	IFNULL(Tec_Furt_Educ_inst_Tot_M,0),
	IFNULL(Tec_Furt_Educ_inst_Tot_F,0),
	IFNULL(Tec_Furt_Educ_inst_Tot_P,0),
	IFNULL(Uni_other_Tert_Instit_Tot_M,0),
	IFNULL(Uni_other_Tert_Instit_Tot_F,0),
	IFNULL(Uni_other_Tert_Instit_Tot_P,0),
	IFNULL(Other_type_educ_instit_Tot_M,0),
	IFNULL(Other_type_educ_instit_Tot_F,0),
	IFNULL(Other_type_educ_instit_Tot_P,0),
	IFNULL(Negative_Nil_income_Tot,0),
	IFNULL(HI_1_149_Tot,0),
	IFNULL(HI_150_299_Tot,0),
	IFNULL(HI_300_399_Tot,0),
	IFNULL(HI_400_499_Tot,0),
	IFNULL(HI_500_649_Tot,0),
	IFNULL(HI_650_799_Tot,0),
	IFNULL(HI_800_999_Tot,0),
	IFNULL(HI_1000_1249_Tot,0),
	IFNULL(HI_1250_1499_Tot,0),
	IFNULL(HI_1500_1749_Tot,0),
	IFNULL(HI_1750_1999_Tot,0),
	IFNULL(HI_2000_2499_Tot,0),
	IFNULL(HI_2500_2999_Tot,0),
	IFNULL(HI_3000_3499_Tot,0),
	IFNULL(HI_3500_3999_Tot,0),
	IFNULL(HI_4000_more_Tot,0),
	IFNULL(Num_MVs_per_dweling_0_MVs,0),
	IFNULL(Num_MVs_per_dweling_1_MVs,0),
	IFNULL(Num_MVs_per_dweling_2_MVs,0),
	IFNULL(Num_MVs_per_dweling_3_MVs,0),
	IFNULL(Num_MVs_per_dweling_4mo_MVs,0),
	IFNULL(Total_FamHhold,0),
	IFNULL(Total_NonFamHhold,0),
	IFNULL(OPDs_Separate_house_Persons,0),
	IFNULL(OPDs_SD_r_t_h_th_1_sty_Psns,0),
	IFNULL(OPDs_SD_r_t_h_th_2_m_sty_Psns,0),
	IFNULL(OPDs_SD_r_t_h_th_Tot_Psns,0),
	IFNULL(OPDs_F_ap_I_1or2_sty_blk_Ps,0),
	IFNULL(OPDs_F_ap_I_3_sty_blk_Psns,0),
	IFNULL(OPDs_F_ap_I_4_m_sty_blk_Ps,0),
	IFNULL(OPDs_Flt_apt_Att_house_Ps,0),
	IFNULL(OPDs_Flt_apart_Tot_Psns,0),
	IFNULL(OPDs_Oth_dw_Cvn_Ps,0),
	IFNULL(OPDs_Oth_dwg_cab_hboat_Ps,0),
	IFNULL(OPDs_Ot_dwg_Im_hm_tnt_SO_Ps,0),
	IFNULL(OPDs_Ot_dwg_Hs_f_att_sh_of_Ps,0),
	IFNULL(OPDs_Other_dwelling_Tot_Psns,0),
	IFNULL(OPDs_Dwlling_structur_NS_Psns,0),
	IFNULL(OPDs_Tot_OPDs_Persons,0),
	IFNULL(Total_PDs_Persons,0),
	IFNULL(P_Ag_For_Fshg_Tot,0),
	IFNULL(P_Mining_Tot,0),
	IFNULL(P_Manufact_Tot,0),
	IFNULL(P_El_Gas_Wt_Waste_Tot,0),
	IFNULL(P_Constru_Tot,0),
	IFNULL(P_WhlesaleTde_Tot,0),
	IFNULL(P_RetTde_Tot,0),
	IFNULL(P_Accom_food_Tot,0),
	IFNULL(P_Trans_post_wrehsg_Tot,0),
	IFNULL(P_Info_media_teleco_Tot,0),
	IFNULL(P_Fin_Insur_Tot,0),
	IFNULL(P_RtnHir_REst_Tot,0),
	IFNULL(P_Pro_scien_tec_Tot,0),
	IFNULL(P_Admin_supp_Tot,0),
	IFNULL(P_Public_admin_sfty_Tot,0),
	IFNULL(P_Educ_trng_Tot,0),
	IFNULL(P_HlthCare_SocAs_Tot,0),
	IFNULL(P_Art_recn_Tot,0),
	IFNULL(P_Oth_scs_Tot,0),
	IFNULL(P_ID_NS_Tot,0),
	IFNULL(P_Tot_Managers,0),
	IFNULL(P_Tot_Professionals,0),
	IFNULL(P_Tot_TechnicTrades_W,0),
	IFNULL(P_Tot_CommunPersnlSvc_W,0),
	IFNULL(P_Tot_ClericalAdminis_W,0),
	IFNULL(P_Tot_Sales_W,0),
	IFNULL(P_Tot_Mach_oper_drivers,0),
	IFNULL(P_Tot_Labourers,0),
	IFNULL(Ancestry_Aust_NZ_P,0),
	IFNULL(Ancestry_UK_Ire_P,0),
	IFNULL(Ancestry_Other_Europe_P,0),
	IFNULL(Ancestry_Western_Asia_P,0),
	IFNULL(Ancestry_Southern_Asia_P,0),
	IFNULL(Ancestry_Eastern_Asia_P,0),
	IFNULL(Ancestry_South_Eastern_Asia_P,0),
	IFNULL(Ancestry_Elsewhere_P,0),
	IFNULL(Born_Aust_NZ_P,0),
	IFNULL(Born_UK_Ire_P,0),
	IFNULL(Born_Other_Europe_P,0),
	IFNULL(Born_Western_Asia_P,0),
	IFNULL(Born_Southern_Asia_P,0),
	IFNULL(Born_Eastern_Asia_P,0),
	IFNULL(Born_South_Eastern_Asia_P,0),
	IFNULL(Born_Elsewhere_P,0),
	IFNULL(Ancestry_Aboriginal_Only_P,0),
	IFNULL(Religion_Non_Drinking_P,0),
	IFNULL(Ave_Basket_Size,0),
	IFNULL(Ave_basket_Size_Units,0),
	IFNULL(Morning_6to10,0),
	IFNULL(Day_11to4,0),
	IFNULL(Night_5onwards,0),
	IFNULL(Weekend,0),
	IFNULL(B_Prop,0),
	IFNULL(M_Prop,0),
	IFNULL(P_Prop,0),
	IFNULL(HasCafe,0),
	IFNULL(FOS_Prop,0),
	IFNULL(FFN_Prop,0),
	IFNULL(FFL_Prop,0),
	IFNULL(Emergency_Impulse,0),
	IFNULL(Non_Food_Shop,0),
	IFNULL(Food_Shop,0),
	IFNULL(non_promo_prop,0),
	IFNULL(Fresh_Foodies,0),
	IFNULL(Modern_Families,0),
	IFNULL(Healthy_Premium_Entertaining,0),
	IFNULL(Cigarette_Impulse,0),
	IFNULL(Grab_Go,0),
	IFNULL(Sales_Proportion_Budget,0),
	IFNULL(Sales_Proportion_Mainstream,0),
	IFNULL(Sales_Proportion_Premium,0),
	IFNULL(Sales_Proportion_New_Families,0),
	IFNULL(Sales_Proportion_Young_Families,0),
	IFNULL(Sales_Proportion_Older_Families,0),
	IFNULL(Sales_Proportion_Young_Singles_Couples,0),
	IFNULL(Sales_Proportion_Midage_Singles_Couples,0),
	IFNULL(Sales_Proportion_Older_Singles_Couples,0),
	IFNULL(Sales_Proportion_Retirees,0),
	IFNULL(Sales_Proportion_Ultra_Healthy,0),
	IFNULL(Sales_Proportion_Free_From,0),
	IFNULL(Sales_Proportion_High_Protein_Traditionalists,0),
	IFNULL(Sales_Proportion_Health_Newcomer,0),
	IFNULL(Sales_Proportion_Convenience_Driven,0),
	IFNULL(Sales_Proportion_Unhealthy_Snackers,0),
	IFNULL(European,0),
	IFNULL(Mpi,0),
	IFNULL(Asianindian,0),
	IFNULL(Christian,0),
	IFNULL(Hindu,0),
	IFNULL(Muslim,0),
	IFNULL(Affluence,0),
	IFNULL(Holiday,0),
	IFNULL(UniArea,0),
	IFNULL(Prop_Student_Allowance,0),
	"TOPDTLDEMOFL",
	CURRENT_TIMESTAMP(),
	"TOPDTLDEMOFL",
	CURRENT_TIMESTAMP()

FROM
	`{{ params.project_ID }}.{{ params.Optumera_Stage_DS }}.Stage_Demographics` allbnz
INNER JOIN
	`{{ params.project_ID }}.{{ params.Optumera_Target_DS }}.Store` ts 
ON
	allbnz.Store_Number = ts.Store_Number AND 
	allbnz.sales_org = ts.TEXT_1 AND 
	ts.ACTIVE_F = 'Y' )